<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

  <!-- React & ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600&family=Syne:wght@700;800&family=JetBrains+Mono:wght@400;500&display=swap');

    * { box-sizing: border-box; margin: 0; padding: 0; }

    .container {
      padding: 32px;
    }

    /* Header */
    .header h2 {
      font-family: 'Syne', sans-serif;
      font-weight: 800;
      font-size: 30px;
      color: var(--text-heading);
      letter-spacing: -1px;
      margin-bottom: 4px;
    }

    .header p {
      font-size: 13px;
      color: var(--text-dim);
      letter-spacing: 0.2px;
    }

    /* Stat Cards */
    .stat-cards {
      display: flex;
      gap: 16px;
      margin: 28px 0;
    }

    .stat-card {
      flex: 1;
      padding: 16px 20px;
      border-radius: 14px;
      transition: all 0.2s ease;
    }

    .stat-card:hover {
      transform: translateY(-2px);
    }

    .stat-card .stat-label {
      font-size: 11px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.8px;
      margin-bottom: 8px;
    }

    .stat-card .stat-value {
      font-family: 'Syne', sans-serif;
      font-size: 28px;
      font-weight: 800;
    }

    /* Toolbar */
    .toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .btn-new {
      background: linear-gradient(135deg, var(--accent), var(--accent-dark));
      color: #fff;
      padding: 10px 20px;
      border-radius: 10px;
      border: none;
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.2px;
      cursor: pointer;
      box-shadow: 0 4px 16px var(--accent-glow);
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s ease;
      font-family: inherit;
    }

    .btn-new:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 24px var(--accent-glow-strong);
    }

    .search-input {
      background: var(--bg-input);
      border: 1px solid var(--border-input);
      border-radius: 10px;
      padding: 9px 14px 9px 34px;
      color: var(--text-heading);
      font-size: 13px;
      width: 240px;
      transition: all 0.2s ease;
      font-family: inherit;
    }

    .search-input:focus {
      outline: none;
      border-color: var(--accent-focus);
      box-shadow: 0 0 0 3px var(--accent-ring);
    }

    .search-input::placeholder {
      color: var(--text-placeholder);
    }

    /* Table */
    .table-container {
      border-radius: 16px;
      border: 1px solid var(--border-color);
      overflow-x: auto;
      background: var(--bg-surface);
    }

    .table-header {
      display: grid;
      grid-template-columns: 80px 1fr 100px 100px 100px 1fr 110px 1fr 100px 1fr 70px;
      padding: 12px 20px;
      background: var(--bg-elevated);
      border-bottom: 1px solid var(--border-color);
      min-width: 1200px;
    }

    .table-header-cell {
      font-size: 10px;
      font-weight: 600;
      letter-spacing: 1px;
      color: var(--text-dim);
      text-transform: uppercase;
      font-family: 'JetBrains Mono', monospace;
    }

    .table-row {
      display: grid;
      grid-template-columns: 80px 1fr 100px 100px 100px 1fr 110px 1fr 100px 1fr 70px;
      padding: 13px 20px;
      align-items: center;
      transition: all 0.2s ease;
      cursor: pointer;
      border-bottom: 1px solid var(--border-subtle);
      min-width: 1200px;
    }

    .table-row:last-child {
      border-bottom: none;
    }

    .table-row:hover {
      background: var(--bg-hover);
      transform: translateX(3px);
    }

    /* Avatar */
    .avatar {
      width: 30px;
      height: 30px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      font-weight: 700;
      letter-spacing: 0.5px;
      flex-shrink: 0;
    }

    /* Role Badge */
    .role-badge {
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.5px;
      padding: 4px 10px;
      border-radius: 20px;
      display: inline-block;
    }

    /* Action Buttons */
    .action-btn {
      background: none;
      border: none;
      cursor: pointer;
      padding: 4px;
      font-size: 14px;
      transition: all 0.15s ease;
      opacity: 0.4;
    }

    .action-btn:hover {
      opacity: 1;
      transform: scale(1.15);
    }

    .action-btn.edit {
      color: var(--action-edit);
    }

    .action-btn.delete {
      color: var(--action-delete);
    }

    /* Footer */
    .footer-count {
      margin-top: 16px;
      font-size: 12px;
      color: var(--text-subtle);
      text-align: right;
    }

    /* Loading */
    .loading-container {
      padding: 60px;
      text-align: center;
      color: var(--text-dim);
      font-size: 14px;
    }

    .empty-state {
      padding: 40px;
      text-align: center;
      color: var(--text-subtle);
      font-style: italic;
      font-size: 13px;
    }

    /* Dialog Overlay */
    .dialog-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: var(--bg-overlay);
      backdrop-filter: blur(4px);
      z-index: 999;
    }

    .dialog-container {
      position: fixed;
      width: 520px;
      background: var(--bg-dialog);
      border-radius: 16px;
      box-shadow: var(--shadow-dialog);
      border: 1px solid var(--border-input);
      z-index: 1000;
      display: flex;
      flex-direction: column;
      max-height: 85vh;
    }

    .dialog-header {
      padding: 16px 20px;
      border-bottom: 1px solid var(--border-dialog);
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: move;
      background: var(--bg-dialog-header);
      border-radius: 16px 16px 0 0;
    }

    .dialog-header h3 {
      margin: 0;
      font-family: 'Syne', sans-serif;
      font-weight: 700;
      font-size: 16px;
      color: var(--text-heading);
    }

    .dialog-close {
      cursor: pointer;
      color: var(--text-subtle);
      font-size: 16px;
      transition: color 0.2s;
    }

    .dialog-close:hover {
      color: var(--action-delete);
    }

    .dialog-content {
      padding: 20px;
      overflow-y: auto;
    }

    .dialog-footer {
      padding: 16px 20px;
      border-top: 1px solid var(--border-dialog);
      display: flex;
      justify-content: flex-end;
      gap: 12px;
      background: var(--bg-dialog-header);
      border-radius: 0 0 16px 16px;
    }

    /* Form */
    .form-group {
      margin-bottom: 16px;
    }

    .form-group label {
      font-size: 12px;
      color: var(--text-secondary);
      font-weight: 500;
      display: block;
      margin-bottom: 6px;
      letter-spacing: 0.3px;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      box-sizing: border-box;
      padding: 10px 12px;
      background: var(--bg-input);
      border: 1px solid var(--border-input);
      border-radius: 10px;
      color: var(--text-body);
      font-family: inherit;
      font-size: 13px;
      transition: all 0.2s;
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: var(--accent-focus);
      box-shadow: 0 0 0 3px var(--accent-ring);
    }

    .form-group input::placeholder,
    .form-group textarea::placeholder {
      color: var(--text-placeholder);
    }

    .form-group select option {
      background: var(--select-option-bg);
      color: var(--select-option-text);
    }

    .form-row {
      display: flex;
      gap: 16px;
    }

    .flex-1 {
      flex: 1;
    }

    .input-bg-gray {
      background: var(--input-readonly-bg) !important;
    }

    .generated-id-group {
      display: flex;
      gap: 8px;
    }

    .btn-secondary {
      background: var(--btn-secondary-bg);
      color: var(--btn-secondary-text);
      border: 1px solid var(--btn-secondary-border);
      padding: 10px 16px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 500;
      font-size: 13px;
      transition: all 0.2s;
      font-family: inherit;
    }

    .btn-secondary:hover {
      background: var(--btn-secondary-hover-bg);
      border-color: var(--btn-secondary-hover-border);
    }

    .btn-save {
      background: linear-gradient(135deg, var(--accent), var(--accent-dark));
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      font-size: 13px;
      transition: all 0.2s;
      font-family: inherit;
    }

    .btn-save:hover {
      box-shadow: 0 4px 16px var(--accent-glow);
      transform: translateY(-1px);
    }

    /* Toast */
    .toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: var(--toast-bg);
      color: var(--toast-text);
      padding: 12px 24px;
      border-radius: 12px;
      border: 1px solid var(--toast-border);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
      z-index: 2000;
      font-size: 13px;
      animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
      from { transform: translateY(100%); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    const roleConfig = {
      Investor: { bg: "rgba(52, 211, 153, 0.15)", color: "#34D399", border: "rgba(52, 211, 153, 0.3)" },
      Borrower: { bg: "rgba(251, 146, 60, 0.15)", color: "#FB923C", border: "rgba(251, 146, 60, 0.3)" },
      Both: { bg: "rgba(139, 92, 246, 0.15)", color: "#A78BFA", border: "rgba(139, 92, 246, 0.3)" },
    };

    const avatarColors = [
      "#34D399", "#60A5FA", "#FB923C", "#F472B6", "#A78BFA", "#FBBF24", "#2DD4BF", "#F87171"
    ];

    function getInitials(name) {
      if (!name) return "?";
      return name.split(" ").slice(0, 2).map(w => w[0]).join("").toUpperCase();
    }

    function getAvatarColor(name) {
      if (!name) return avatarColors[0];
      let hash = 0;
      for (let c of name) hash = (hash + c.charCodeAt(0)) % avatarColors.length;
      return avatarColors[hash];
    }

    const App = () => {
      const [parties, setParties] = useState([]);
      const [investorTypes, setInvestorTypes] = useState([]);
      const [loading, setLoading] = useState(true);
      const [searchTerm, setSearchTerm] = useState("");
      const [isModalOpen, setIsModalOpen] = useState(false);
      const [currentParty, setCurrentParty] = useState(null);
      const [toast, setToast] = useState(null);
      const [hoveredRow, setHoveredRow] = useState(null);

      const loadData = () => {
        setLoading(true);
        if (typeof google !== 'undefined' && google.script) {
          google.script.run
            .withSuccessHandler((data) => {
              setParties(data);
              setLoading(false);
            })
            .withFailureHandler((err) => {
              showToast("Error loading data: " + err.message);
              setLoading(false);
            })
            .partyGetDataJSON();

          google.script.run
            .withSuccessHandler((data) => {
              if (data && data.partyTypes) setInvestorTypes(data.partyTypes);
            })
            .partyGetFormData();
        } else {
          setLoading(false);
        }
      };

      useEffect(() => {
        loadData();
      }, []);

      const showToast = (msg) => {
        setToast(msg);
        setTimeout(() => setToast(null), 3000);
      };

      const filteredParties = useMemo(() => {
        if (!searchTerm) return parties;
        const lower = searchTerm.toLowerCase();
        return parties.filter(p =>
          (p.party_name && p.party_name.toLowerCase().includes(lower)) ||
          (p.party_id && p.party_id.toLowerCase().includes(lower)) ||
          (p.email && p.email.toLowerCase().includes(lower))
        );
      }, [parties, searchTerm]);

      // Stats
      const investors = parties.filter(p => p.role_type === "Investor").length;
      const borrowers = parties.filter(p => p.role_type === "Borrower").length;
      const companies = parties.filter(p => p.party_type === "Company").length;

      const handleAdd = () => {
        setCurrentParty(null);
        setIsModalOpen(true);
      };

      const handleEdit = (party) => {
        setCurrentParty(party);
        setIsModalOpen(true);
      };

      const handleDelete = (id) => {
        if (confirm(`Are you sure you want to delete Party ${id}?`)) {
          if (typeof google !== 'undefined' && google.script) {
            google.script.run
              .withSuccessHandler(() => {
                showToast("Party deleted successfully");
                loadData();
              })
              .partyDelete(id);
          }
        }
      };

      const handleSave = (formData) => {
        if (typeof google !== 'undefined' && google.script) {
          const fn = currentParty ? 'partyUpdate' : 'partySave';
          google.script.run
            .withSuccessHandler(() => {
              showToast(currentParty ? "Party updated" : "Party created");
              setIsModalOpen(false);
              loadData();
            })
            .withFailureHandler((err) => {
              showToast("Error: " + err.message);
            })
          [fn](formData);
        }
      };

      const statCards = [
        { label: "Total Parties", value: parties.length, colorVar: "--stat-total-color", bgVar: "--stat-total-bg", borderVar: "--stat-total-border" },
        { label: "Investors", value: investors, colorVar: "--stat-investor-color", bgVar: "--stat-investor-bg", borderVar: "--stat-investor-border" },
        { label: "Borrowers", value: borrowers, colorVar: "--stat-borrower-color", bgVar: "--stat-borrower-bg", borderVar: "--stat-borrower-border" },
        { label: "Companies", value: companies, colorVar: "--stat-company-color", bgVar: "--stat-company-bg", borderVar: "--stat-company-border" },
      ];

      return (
        <div className="container">
          <div className="header">
            <h2>Parties</h2>
            <p>Manage Investors, Borrowers, and Companies</p>
          </div>

          {/* Stat Cards */}
          <div className="stat-cards">
            {statCards.map(stat => (
              <div key={stat.label} className="stat-card" style={{
                background: `var(${stat.bgVar})`,
                border: `1px solid var(${stat.borderVar})`,
              }}>
                <div className="stat-label">{stat.label}</div>
                <div className="stat-value" style={{ color: `var(${stat.colorVar})` }}>{stat.value}</div>
              </div>
            ))}
          </div>

          {/* Toolbar */}
          <div className="toolbar">
            <button className="btn-new" onClick={handleAdd}>
              <span style={{ fontSize: 16, lineHeight: 1 }}>+</span> New Party
            </button>
            <div style={{ position: 'relative' }}>
              <span style={{
                position: 'absolute', left: 12, top: '50%', transform: 'translateY(-50%)',
                color: 'var(--search-icon)', fontSize: 14
              }}><i className="fa fa-search" style={{ fontSize: 12 }}></i></span>
              <input
                className="search-input"
                type="text"
                placeholder="Search parties..."
                value={searchTerm}
                onChange={(e) => setSearchTerm(e.target.value)}
              />
            </div>
          </div>

          {/* Table */}
          <div className="table-container">
            <div className="table-header">
              {["ID", "NAME", "TYPE", "ROLE", "INV. TYPE", "EMAIL", "PHONE", "ADDRESS", "TAX ID", "BANK INFO", "ACTIONS"].map(col => (
                <div key={col} className="table-header-cell">{col}</div>
              ))}
            </div>

            {loading ? (
              <div className="loading-container">
                <i className="fa fa-spinner fa-spin" style={{ marginRight: 8 }}></i> Loading parties...
              </div>
            ) : (
              <>
                {filteredParties.map((party, i) => {
                  const role = roleConfig[party.role_type] || roleConfig.Investor;
                  const color = getAvatarColor(party.party_name);
                  return (
                    <div
                      key={party.party_id}
                      className="table-row"
                      onMouseEnter={() => setHoveredRow(party.party_id)}
                      onMouseLeave={() => setHoveredRow(null)}
                    >
                      {/* ID */}
                      <div style={{
                        fontFamily: "'JetBrains Mono', monospace",
                        fontSize: 11.5, color: "var(--text-muted)", letterSpacing: "0.5px"
                      }}>{party.party_id}</div>

                      {/* Name + Avatar */}
                      <div style={{ display: "flex", alignItems: "center", gap: 10 }}>
                        <div className="avatar" style={{
                          background: `${color}22`,
                          border: `1px solid ${color}44`,
                          color: color,
                        }}>
                          {getInitials(party.party_name)}
                        </div>
                        <span style={{ fontSize: 13.5, fontWeight: 500, color: "var(--text-name)" }}>
                          {party.party_name}
                        </span>
                      </div>

                      {/* Type */}
                      <div style={{ fontSize: 12.5, color: "var(--text-cell)" }}>
                        {party.party_type === "Company" ? (
                          <span style={{ color: "#A78BFA" }}><i className="fa fa-building" style={{ fontSize: 10, marginRight: 4 }}></i> Company</span>
                        ) : (
                          <span><i className="fa fa-user" style={{ fontSize: 10, marginRight: 4 }}></i> Individual</span>
                        )}
                      </div>

                      {/* Role Badge */}
                      <div>
                        <span className="role-badge" style={{
                          background: role.bg, color: role.color,
                          border: `1px solid ${role.border}`,
                        }}>
                          {party.role_type}
                        </span>
                      </div>

                      {/* Investor Type */}
                      <div style={{
                        fontSize: 12, color: "var(--text-dim)",
                        overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap",
                      }}>
                        {party.investor_type || <span style={{ color: "var(--text-faint)" }}>—</span>}
                      </div>

                      {/* Email */}
                      <div style={{
                        fontSize: 12, color: "var(--text-dim)",
                        overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap",
                      }}>
                        {party.email || <span style={{ color: "var(--text-faint)" }}>—</span>}
                      </div>

                      {/* Phone */}
                      <div style={{
                        fontSize: 12, color: "var(--text-dim)",
                        overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap",
                      }}>
                        {party.phone || <span style={{ color: "var(--text-faint)" }}>—</span>}
                      </div>

                      {/* Address */}
                      <div style={{
                        fontSize: 12, color: "var(--text-dim)",
                        overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap",
                      }}>
                        {party.address || <span style={{ color: "var(--text-faint)" }}>—</span>}
                      </div>

                      {/* Tax ID */}
                      <div style={{
                        fontSize: 12, color: "var(--text-dim)",
                        overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap",
                      }}>
                        {party.tax_id || <span style={{ color: "var(--text-faint)" }}>—</span>}
                      </div>

                      {/* Bank Info */}
                      <div style={{
                        fontSize: 12, color: "var(--text-dim)",
                        overflow: "hidden", textOverflow: "ellipsis", whiteSpace: "nowrap",
                      }}>
                        {party.bank_info || <span style={{ color: "var(--text-faint)" }}>—</span>}
                      </div>

                      {/* Actions */}
                      <div style={{ display: "flex", gap: 8 }}>
                        <button
                          className="action-btn edit"
                          title="Edit"
                          onClick={() => handleEdit(party)}
                          style={{ opacity: hoveredRow === party.party_id ? 0.8 : 0.3 }}
                        ><i className="fa fa-pen"></i></button>
                        <button
                          className="action-btn delete"
                          title="Delete"
                          onClick={() => handleDelete(party.party_id)}
                          style={{ opacity: hoveredRow === party.party_id ? 0.8 : 0.2 }}
                        ><i className="fa fa-trash"></i></button>
                      </div>
                    </div>
                  );
                })}

                {filteredParties.length === 0 && (
                  <div className="empty-state">No parties found.</div>
                )}
              </>
            )}
          </div>

          {/* Footer */}
          <div className="footer-count">
            Showing {filteredParties.length} of {parties.length} parties
          </div>

          {isModalOpen && (
            <PartyDialog
              party={currentParty}
              investorTypes={investorTypes}
              onClose={() => setIsModalOpen(false)}
              onSave={handleSave}
            />
          )}

          {toast && <div className="toast">{toast}</div>}
        </div>
      );
    };

    const PartyDialog = ({ party, investorTypes, onClose, onSave }) => {
      const [formData, setFormData] = useState({
        party_id: '',
        party_name: '',
        party_type: 'Individual',
        role_type: 'Investor',
        investor_type: '',
        email: '',
        phone: '',
        address: '',
        tax_id: '',
        bank_info: '',
        notes: ''
      });

      const [position, setPosition] = useState({ x: 0, y: 60 });
      const [isDragging, setIsDragging] = useState(false);
      const [dragOffset, setDragOffset] = useState({ x: 0, y: 0 });

      useEffect(() => {
        const x = (window.innerWidth - 520) / 2;
        setPosition({ x, y: 60 });
      }, []);

      const handleMouseDown = (e) => {
        setIsDragging(true);
        setDragOffset({
          x: e.clientX - position.x,
          y: e.clientY - position.y
        });
      };

      useEffect(() => {
        const handleMouseMove = (e) => {
          if (isDragging) {
            setPosition({
              x: e.clientX - dragOffset.x,
              y: e.clientY - dragOffset.y
            });
          }
        };
        const handleMouseUp = () => setIsDragging(false);

        if (isDragging) {
          window.addEventListener('mousemove', handleMouseMove);
          window.addEventListener('mouseup', handleMouseUp);
        }
        return () => {
          window.removeEventListener('mousemove', handleMouseMove);
          window.removeEventListener('mouseup', handleMouseUp);
        };
      }, [isDragging, dragOffset]);

      const [loadingId, setLoadingId] = useState(false);

      useEffect(() => {
        if (party) {
          setFormData(party);
        }
      }, [party]);

      const handleChange = (e) => {
        const { name, value } = e.target;
        setFormData(prev => ({ ...prev, [name]: value }));
      };

      const generateId = () => {
        setLoadingId(true);
        if (typeof google !== 'undefined' && google.script) {
          google.script.run.withSuccessHandler(id => {
            setFormData(prev => ({ ...prev, party_id: id }));
            setLoadingId(false);
          }).partyGenerateID();
        }
      };

      const handleSubmit = () => {
        if (!formData.party_name || !formData.role_type) {
          alert("Name and Role are required");
          return;
        }
        onSave(formData);
      };

      return (
        <>
          <div className="dialog-overlay" onClick={onClose}></div>
          <div
            className="dialog-container"
            style={{ left: position.x, top: position.y, transform: 'none' }}
          >
            <div className="dialog-header" onMouseDown={handleMouseDown}>
              <h3>{party ? 'Edit Party' : 'New Party'}</h3>
              <i className="fa fa-times dialog-close" onClick={onClose}></i>
            </div>
            <div className="dialog-content">
              <div className="form-group">
                <label>Party ID</label>
                <div className="generated-id-group">
                  <input name="party_id" value={formData.party_id} readOnly placeholder="Auto-generate" className="input-bg-gray" />
                  {!party && <button className="btn-secondary" onClick={generateId} disabled={loadingId}>
                    {loadingId ? '...' : 'Generate'}
                  </button>}
                </div>
              </div>

              <div className="form-group">
                <label>Name *</label>
                <input name="party_name" value={formData.party_name} onChange={handleChange} autoFocus placeholder="Enter party name" />
              </div>

              <div className="form-row">
                <div className="form-group flex-1">
                  <label>Type</label>
                  <select name="party_type" value={formData.party_type} onChange={handleChange}>
                    <option value="Individual">Individual</option>
                    <option value="Company">Company</option>
                  </select>
                </div>
                <div className="form-group flex-1">
                  <label>Role *</label>
                  <select name="role_type" value={formData.role_type} onChange={handleChange}>
                    <option value="Investor">Investor</option>
                    <option value="Borrower">Borrower</option>
                    <option value="Both">Both</option>
                  </select>
                </div>
              </div>

              <div className="form-group">
                <label>Party Type (Optional)</label>
                <select name="investor_type" value={formData.investor_type} onChange={handleChange}>
                  <option value="">-- Select --</option>
                  {investorTypes.map(t => <option key={t} value={t}>{t}</option>)}
                </select>
              </div>

              <div className="form-row">
                <div className="form-group flex-1">
                  <label>Email</label>
                  <input name="email" value={formData.email} onChange={handleChange} placeholder="email@example.com" />
                </div>
                <div className="form-group flex-1">
                  <label>Phone</label>
                  <input name="phone" value={formData.phone} onChange={handleChange} placeholder="Phone number" />
                </div>
              </div>

              <div className="form-group">
                <label>Address</label>
                <input name="address" value={formData.address} onChange={handleChange} placeholder="Street address" />
              </div>

              <div className="form-row">
                <div className="form-group flex-1">
                  <label>Tax ID</label>
                  <input name="tax_id" value={formData.tax_id} onChange={handleChange} />
                </div>
                <div className="form-group flex-1">
                  <label>Bank Info</label>
                  <input name="bank_info" value={formData.bank_info} onChange={handleChange} />
                </div>
              </div>

              <div className="form-group">
                <label>Notes</label>
                <textarea name="notes" value={formData.notes} onChange={handleChange} rows="3" placeholder="Additional notes..."></textarea>
              </div>
            </div>
            <div className="dialog-footer">
              <button className="btn-secondary" onClick={onClose}>Cancel</button>
              <button className="btn-save" onClick={handleSubmit}>{party ? 'Update' : 'Save'}</button>
            </div>
          </div>
        </>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>

</html>